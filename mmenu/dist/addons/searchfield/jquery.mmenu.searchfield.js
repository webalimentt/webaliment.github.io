!function(e){function n(e,n){if(n)for(var s in n)e.attr(s,n[s])}function s(e){switch(e){case 9:case 16:case 17:case 18:case 37:case 38:case 39:case 40:return!0}return!1}var a="mmenu",t="searchfield";e[a].addons[t]={setup:function(){var n=this,s=this.opts[t],l=this.conf[t];r=e[a].glbl,"boolean"==typeof s&&(s={add:s}),"object"!=typeof s&&(s={}),"boolean"==typeof s.panel&&(s.panel={add:s.panel}),"object"!=typeof s.panel&&(s.panel={}),s.add&&("panel"==s.addTo&&(s.panel.add=!0),s.panel.add&&(s.showSubPanels=!1,s.panel.splash&&(s.cancel=!0)),s=this.opts[t]=e.extend(!0,{},e[a].defaults[t],s),l=this.conf[t]=e.extend(!0,{},e[a].configuration[t],l),this.bind("close:start",function(){this.$menu.find("."+i.searchfield).children("input").blur()}),this.bind("initPanels:after",function(a){var t=e();s.panel.add&&(t=this._initSearchPanel(a));var i;switch(s.addTo){case"panels":i=a;break;case"panel":i=t;break;default:i=this.$menu.find(s.addTo)}if(i.each(function(){var a=n._initSearchfield(e(this));s.search&&a.length&&n._initSearching(a)}),s.noResults){var l=s.panel.add?t:a;l.each(function(){n._initNoResultsMsg(e(this))})}}))},add:function(){i=e[a]._c,l=e[a]._d,d=e[a]._e,i.add("searchfield"),l.add("searchfield"),d.add("input focus blur")},clickAnchor:function(e,n){if(e.hasClass(i.searchfield+"__btn")){if(e.hasClass(i.btn+"_close")){var s=e.closest("."+i.searchfield).find("input");return s.val(""),this.search(s),!0}if(e.hasClass(i.btn+"_next"))return e.closest("."+i.searchfield).submit(),!0}}},e[a].defaults[t]={add:!1,addTo:"panels",noResults:"No results found.",placeholder:"Search",panel:{add:!1,dividers:!0,fx:"none",id:null,splash:null,title:"Search"},search:!0,showTextItems:!1,showSubPanels:!0},e[a].configuration[t]={clear:!1,form:!1,input:!1,submit:!1};var i,l,d,r;e[a].prototype._initSearchPanel=function(n){var s=this.opts[t];this.conf[t];if(this.$pnls.children("."+i.panel+"_search").length)return e();var a=e('<div class="'+i.panel+'_search " />').append("<ul />").appendTo(this.$pnls);switch(s.panel.id&&a.attr("id",s.panel.id),s.panel.title&&a.attr("data-mm-title",s.panel.title),s.panel.fx){case!1:break;case"none":a.addClass(i.panel+"_noanimation");break;default:a.addClass(i.panel+"_fx-"+s.panel.fx)}return s.panel.splash&&a.append('<div class="'+i.panel+'__searchsplash">'+s.panel.splash+"</div>"),this._initPanels(a),a},e[a].prototype._initSearchfield=function(s){var a=this.opts[t],l=this.conf[t];if(s.parent("."+i.listitem+"_vertical").length)return e();if(s.find("."+i.searchfield).length)return e();var d=e("<"+(l.form?"form":"div")+' class="'+i.searchfield+'" />'),r=e('<div class="'+i.searchfield+'__input" />'),h=e('<input placeholder="'+this.i18n(a.placeholder)+'" type="text" autocomplete="off" />');return r.append(h).appendTo(d),s.hasClass(i.searchfield)?s.replaceWith(d):(s.prepend(d),s.hasClass(i.panel)&&s.addClass(i.panel+"_has-searchfield")),n(h,l.input),l.clear&&e('<a class="'+i.btn+" "+i.btn+"_close "+i.searchfield+'__btn" href="#" />').appendTo(r),n(d,l.form),l.form&&l.submit&&!l.clear&&e('<a class="'+i.btn+" "+i.btn+"_next "+i.searchfield+'__btn" href="#" />').appendTo(r),a.cancel&&e('<a href="#" class="'+i.searchfield+'__cancel">'+this.i18n("cancel")+"</a>").appendTo(d),d},e[a].prototype._initSearching=function(n){var a=this,r=this.opts[t],h=(this.conf[t],{});n.closest("."+i.panel+"_search").length?(h.$pnls=this.$pnls.find("."+i.panel),h.$nrsp=n.closest("."+i.panel)):n.closest("."+i.panel).length?(h.$pnls=n.closest("."+i.panel),h.$nrsp=h.$pnls):(h.$pnls=this.$pnls.find("."+i.panel),h.$nrsp=this.$menu),h.$pnls=h.$pnls.not(function(){return e(this).parent("."+i.listitem+"_vertical").length}),r.panel.add&&(h.$pnls=h.$pnls.not("."+i.panel+"_search"));var c=n.find("input"),p=n.find("."+i.searchfield+"__cancel"),o=this.$pnls.children("."+i.panel+"_search"),f=h.$pnls.find("."+i.listitem);h.$itms=f.not("."+i.listitem+"_divider"),h.$dvdr=f.filter("."+i.listitem+"_divider"),r.panel.add&&r.panel.splash&&c.off(d.focus+"-"+t+"-splash").on(d.focus+"-"+t+"-splash",function(e){a.openPanel(o)}),r.cancel&&(c.off(d.focus+"-"+t+"-cancel").on(d.focus+"-"+t+"-cancel",function(e){p.addClass(i.searchfield+"__cancel-active")}),p.off(d.click+"-"+t+"-splash").on(d.click+"-"+t+"-splash",function(n){n.preventDefault(),e(this).removeClass(i.searchfield+"__cancel-active"),o.hasClass(i.panel+"_opened")&&a.openPanel(a.$pnls.children("."+i.panel+"_opened-parent").last())})),r.panel.add&&"panel"==r.addTo&&this.bind("openPanel:finish",function(e){e[0]===o[0]&&c.focus()}),c.data(l.searchfield,h).off(d.input+"-"+t).on(d.input+"-"+t,function(e){s(e.keyCode)||a.search(c)}),this.search(c)},e[a].prototype._initNoResultsMsg=function(n){var s=this.opts[t];this.conf[t];if(n.closest("."+i.panel).length||(n=this.$pnls.children("."+i.panel).first()),!n.children("."+i.panel+"__noresultsmsg").length){var a=n.children("."+i.listview).first(),l=e('<div class="'+i.panel+"__noresultsmsg "+i.hidden+'" />').append(this.i18n(s.noResults));a.length?l.insertAfter(a):l.prependTo(n)}},e[a].prototype.search=function(n,s){var a=this,d=this.opts[t];this.conf[t];n=n||this.$menu.find("."+i.searchfield).chidren("input").first(),s=s||n.val(),s=s.toLowerCase().trim();var r="a",h="a, span",c=n.data(l.searchfield),p=n.closest("."+i.searchfield),o=p.find("."+i.btn),f=this.$pnls.children("."+i.panel+"_search"),u=c.$pnls,_=c.$itms,v=c.$dvdr,m=c.$nrsp;if(_.removeClass(i.listitem+"_nosubitems").find("."+i.btn+"_fullwidth-search").removeClass(i.btn+"_fullwidth-search "+i.btn+"_fullwidth"),f.children("."+i.listview).empty(),u.scrollTop(0),s.length){if(_.add(v).addClass(i.hidden),_.each(function(){var n=e(this),a=r;(d.showTextItems||d.showSubPanels&&n.find("."+i.btn+"_next"))&&(a=h),n.children(a).not("."+i.btn+"_next").text().toLowerCase().indexOf(s)>-1&&n.removeClass(i.hidden)}),d.panel.add){var b=e();u.each(function(){var n=a.__filterListItems(e(this).find("."+i.listitem)).clone(!0);n.length&&(d.panel.dividers&&(b=b.add('<li class="'+i.listitem+" "+i.listitem+'_divider">'+e(this).find("."+i.navbar+"__title").text()+"</li>")),b=b.add(n))}),b.find("."+i.mm("toggle")).remove().end().find("."+i.mm("check")).remove().end().find("."+i.btn).remove(),f.children("."+i.listview).append(b),this.openPanel(f)}else d.showSubPanels&&u.each(function(n){var s=e(this);a.__filterListItems(s.find("."+i.listitem)).each(function(){var n=e(this),s=n.data(l.child);s&&s.find("."+i.listview).children().removeClass(i.hidden)})}),e(u.get().reverse()).each(function(s){var t=e(this),d=t.data(l.parent);d&&(a.__filterListItems(t.find("."+i.listitem)).length?d.hasClass(i.hidden)&&d.removeClass(i.hidden).children("."+i.btn+"_next").not("."+i.btn+"_fullwidth").addClass(i.btn+"_fullwidth").addClass(i.btn+"_fullwidth-search"):n.closest("."+i.panel).length||((t.hasClass(i.panel+"_opened")||t.hasClass(i.panel+"_opened-parent"))&&setTimeout(function(){a.openPanel(d.closest("."+i.panel))},(s+1)*(1.5*a.conf.openingInterval)),d.addClass(i.listitem+"_nosubitems")))}),this.__filterListItems(u.find("."+i.listitem)).each(function(){e(this).prevAll("."+i.listitem+"_divider").first().removeClass(i.hidden)});o.removeClass(i.hidden),m.find("."+i.panel+"__noresultsmsg")[_.not("."+i.hidden).length?"addClass":"removeClass"](i.hidden),d.panel.add&&(d.panel.splash&&f.find("."+i.panel+"__searchsplash").addClass(i.hidden),_.add(v).removeClass(i.hidden))}else _.add(v).removeClass(i.hidden),o.addClass(i.hidden),m.find("."+i.panel+"__noresultsmsg").addClass(i.hidden),d.panel.add&&(d.panel.splash?f.find("."+i.panel+"__searchsplash").removeClass(i.hidden):n.closest("."+i.panel+"_search").length||this.openPanel(this.$pnls.children("."+i.panel+"_opened-parent").last()));this.trigger("updateListview")}}(jQuery);